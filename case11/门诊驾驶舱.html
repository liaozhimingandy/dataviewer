<!DOCTYPE html>

<html>
<head>
    <meta charset="UTF-8"/>
    <meta content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"
          name="viewport"/>
    <title>大屏数据可视化 - 模板</title>
    <link href="css/app.css" rel="stylesheet" type="text/css"/>
</head>

<body>
<header id="header">
    <h3 class="header-title">大屏数据可视化模板</h3>
    <!--<div class="header-info header-info-l">数据来源：大数据研究院</div>
     <div class="header-info header-info-r">更新日期：2019-04-30</div>-->
</header>

<footer id="footer"></footer>

<div id="container">
    <div id="flexCon">
        <div class="flex-row">
            <div class="flex-cell flex-cell-l">
                <div class="chart-wrapper">
                    <h3 class="chart-title">图表</h3>
                    <div class="chart-div" id="treemap">
                        <div class="chart-loader">
                            <div class="loader"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<script src="js/jquery-3.3.1.min.js" type="text/javascript"></script>
<script src="js/countUp.min.js" type="text/javascript"></script>
<script src="js/echarts.min.js" type="text/javascript"></script>
<script src="js/echarts-map-china.js" type="text/javascript"></script>
<script src="js/echarts-theme-shine.js" type="text/javascript"></script>
<script src="js/common.js" type="text/javascript"></script>
<script type="text/javascript">
    //获取地域分布数据
    const treemap = echarts.init(document.getElementById("treemap"), "shine");
    const data = [{
        name: "西区",
        value: 199,
        children: [
            {name: "四川", value: 10},
            {name: "甘肃", value: 10},
            {name: "云南", value: 10},
            {name: "广西", value: 10},
        ]
    }, {
        name: "西区2",
        value: 199,
        children: [
            {name: "四川", value: 10},
            {name: "甘肃", value: 10},
            {name: "云南", value: 10},
            {name: "广西", value: 10},
        ]
    }];
    option = {
        title: {
            text: '',
            subtext: '2017/12',
            left: 'leafDepth'
        },
        tooltip: {

            formatter: function (info) {
                // console.log('tool------', info);
                var val = info.data.value;
                var name = info.name;
                return [
                    '<h4>' + name + '</>',
                    '<div>Value:' + val + '</>',
                ].join('\n');
                // return [
                //     '{name|' + name + '}',
                //     '{basic| 资产数量：' + asset_num + '}',
                // ].join('\n');
            },
            // rich: RICH, tooltip不支持富文本

        },
        series: [{
            name: "门诊驾驶舱",
            type: 'treemap',
            leafDepth: 1,
            data: data,
            label: {
                fontSize: 16,
                color: '#fff',
                show: true,
                position: [5, 5],
                formatter: function (params) {
                    var arr = [
                        '{association|' + params.data.name + '}',
                        '{peoNum|' + params.data.value + '}' + '家',
                    ];
                    return arr.join('\n\n');
                },
                rich: {
                    association: {
                        fontSize: 16,
                        color: '#fff',
                    },
                    peoNum: {
                        fontSize: 30,
                        color: '#fff',
                        fontFamily: 'liquidCrystal',
                    },
                }
            },
            //配置每一层级呈现的样式
            levels: [{
                itemStyle: {
                    normal: {
                        borderColor: '#555',
                        borderWidth: 4,
                        gapWidth: 4
                    }
                }
            }, {
                colorSaturation: [0.3, 0.6],
                itemStyle: {
                    normal: {
                        borderColorSaturation: 0.7,
                        gapWidth: 2,
                        borderWidth: 2
                    }
                }
            },],
            //
            /*data: [
             {
                 name: '西区',
                 value: 62,
                 label: {
                     fontSize: 16,
                     color: '#fff',
                     show: true,
                     position: [5, 5],
                     formatter: function(params) {
                         var arr = [
                         '{association|' + params.data.name + '}',
                         '{peoNum|' + params.data.value + '}' + '家',
                         ];
                         return arr.join('\n\n');
                     },
                     rich: {
                         association: {
                             fontSize: 16,
                             color: '#fff',
                         },
                         peoNum: {
                             fontSize: 30,
                             color: '#fff',
                             fontFamily: 'liquidCrystal',
                         },
                     }
                 },
                 children: [{
                     name: '四川',
                     label: {
                         fontSize: 16,
                         color: '#fff',
                         show: true,
                         position: [5, 5],
                         formatter: function(params) {
                             var arr = [
                             '{association|' + params.data.name + '}',
                             '{peoNum|' + params.data.value + '}' + '家',
                             ];
                             return arr.join('\n\n');
                         },
                         rich: {
                             association: {
                                 fontSize: 16,
                                 color: '#fff',
                             },
                             peoNum: {
                                 fontSize: 30,
                                 color: '#fff',
                                 fontFamily: 'liquidCrystal',
                             },
                         }
                     },
                     value: 24
                 }, {
                     name: '甘肃',
                     label: {
                         fontSize: 14,
                         color: '#fff',
                         show: true,
                         position: [5, 5],
                         formatter: function(params) {
                             var arr = [
                             '{association|' + params.data.name + '}',
                             '{peoNum|' + params.data.value + '}' + '家',
                             ];
                             return arr.join('\n\n');
                         },
                         rich: {
                             association: {
                                 fontSize: 16,
                                 color: '#fff',
                             },
                             peoNum: {
                                 fontSize: 30,
                                 color: '#fff',
                                 fontFamily: 'liquidCrystal',
                             },
                         }
                     },
                     value: 26
                 }, {
                     name: '云南',
                     label: {
                         fontSize: 15,
                         color: '#fff',
                         show: true,
                         position: [5, 5],
                         formatter: function(params) {
                             var arr = [
                             '{association|' + params.data.name + '}',
                             '{peoNum|' + params.data.value + '}' + '家',
                             ];
                             return arr.join('\n\n');
                         },
                         rich: {
                             association: {
                                 fontSize: 16,
                                 color: '#fff',
                             },
                             peoNum: {
                                 fontSize: 30,
                                 color: '#fff',
                                 fontFamily: 'liquidCrystal',
                             },
                         }
                     },
                     value: 16
                 }, {
                     name: '贵州',
                     label: {
                         fontSize: 19,
                         color: '#fff',
                         show: true,
                         position: [5, 5],
                         formatter: function(params) {
                             var arr = [
                             '{association|' + params.data.name + '}',
                             '{peoNum|' + params.data.value + '}' + '家',
                             ];
                             return arr.join('\n\n');
                         },
                         rich: {
                             association: {
                                 fontSize: 16,
                                 color: '#fff',
                             },
                             peoNum: {
                                 fontSize: 30,
                                 color: '#fff',
                                 fontFamily: 'liquidCrystal',
                             },
                         }
                     },
                     value: 16
                 }]
             },

             {
                 name: '东区',
                 label: {
                     fontSize: 16,
                     color: '#fff',
                     show: true,
                     position: [5, 5],
                     formatter: function(params) {
                         var arr = [
                         '{association|' + params.data.name + '}',
                         '{peoNum|' + params.data.value + '}' + '家',
                         ];
                         return arr.join('\n\n');
                     },
                     rich: {
                         association: {
                             fontSize: 16,
                             color: '#fff',
                         },
                         peoNum: {
                             fontSize: 30,
                             color: '#fff',
                             fontFamily: 'liquidCrystal',
                         },
                     }
                 },
                 value: 123,
                 children: [{
                     name: '上海',
                     label: {
                         fontSize: 16,
                         color: '#fff',
                         show: true,
                         position: [5, 5],
                         formatter: function(params) {
                             var arr = [
                             '{association|' + params.data.name + '}',
                             '{peoNum|' + params.data.value + '}' + '家',
                             ];
                             return arr.join('\n\n');
                         },
                         rich: {
                             association: {
                                 fontSize: 16,
                                 color: '#fff',
                             },
                             peoNum: {
                                 fontSize: 30,
                                 color: '#fff',
                                 fontFamily: 'liquidCrystal',
                             },
                         }
                     },
                     value: 103,
                     children: [{
                         name: '宝山',
                         label: {
                             fontSize: 16,
                             color: '#fff',
                             show: true,
                             position: [5, 5],
                             formatter: function(params) {
                                 var arr = [
                                 '{association|' + params.data.name + '}',
                                 '{peoNum|' + params.data.value + '}' + '家',
                                 ];
                                 return arr.join('\n\n');
                             },
                             rich: {
                                 association: {
                                     fontSize: 16,
                                     color: '#fff',
                                 },
                                 peoNum: {
                                     fontSize: 30,
                                     color: '#fff',
                                     fontFamily: 'liquidCrystal',
                                 },
                             }
                         },
                         value: 20
                     },
                     {
                         name: '徐汇',
                         label: {
                             fontSize: 16,
                             color: '#fff',
                             show: true,
                             position: [5, 5],
                             formatter: function(params) {
                                 var arr = [
                                 '{association|' + params.data.name + '}',
                                 '{peoNum|' + params.data.value + '}' + '家',
                                 ];
                                 return arr.join('\n\n');
                             },
                             rich: {
                                 association: {
                                     fontSize: 16,
                                     color: '#fff',
                                 },
                                 peoNum: {
                                     fontSize: 30,
                                     color: '#fff',
                                     fontFamily: 'liquidCrystal',
                                 },
                             }
                         },
                         value: 20
                     },
                     {
                         name: '静安',
                         label: {
                             fontSize: 16,
                             color: '#fff',
                             show: true,
                             position: [5, 5],
                             formatter: function(params) {
                                 var arr = [
                                 '{association|' + params.data.name + '}',
                                 '{peoNum|' + params.data.value + '}' + '家',
                                 ];
                                 return arr.join('\n\n');
                             },
                             rich: {
                                 association: {
                                     fontSize: 16,
                                     color: '#fff',
                                 },
                                 peoNum: {
                                     fontSize: 30,
                                     color: '#fff',
                                     fontFamily: 'liquidCrystal',
                                 },
                             }
                         },
                         value: 10
                     },
                     {
                         name: '黄埔',
                         label: {
                             fontSize: 16,
                             color: '#fff',
                             show: true,
                             position: [5, 5],
                             formatter: function(params) {
                                 var arr = [
                                 '{association|' + params.data.name + '}',
                                 '{peoNum|' + params.data.value + '}' + '家',
                                 ];
                                 return arr.join('\n\n');
                             },
                             rich: {
                                 association: {
                                     fontSize: 16,
                                     color: '#fff',
                                 },
                                 peoNum: {
                                     fontSize: 30,
                                     color: '#fff',
                                     fontFamily: 'liquidCrystal',
                                 },
                             }
                         },
                         value: 24
                     },
                     {
                         name: '浦东',
                         label: {
                             fontSize: 16,
                             color: '#fff',
                             show: true,
                             position: [5, 5],
                             formatter: function(params) {
                                 var arr = [
                                 '{association|' + params.data.name + '}',
                                 '{peoNum|' + params.data.value + '}' + '家',
                                 ];
                                 return arr.join('\n\n');
                             },
                             rich: {
                                 association: {
                                     fontSize: 16,
                                     color: '#fff',
                                 },
                                 peoNum: {
                                     fontSize: 30,
                                     color: '#fff',
                                     fontFamily: 'liquidCrystal',
                                 },
                             }
                         },
                         value: 29
                     }
                     ]
                 }, {
                     name: '江苏',
                     label: {
                         fontSize: 16,
                         color: '#fff',
                         show: true,
                         position: [5, 5],
                         formatter: function(params) {
                             var arr = [
                             '{association|' + params.data.name + '}',
                             '{peoNum|' + params.data.value + '}' + '家',
                             ];
                             return arr.join('\n\n');
                         },
                         rich: {
                             association: {
                                 fontSize: 16,
                                 color: '#fff',
                             },
                             peoNum: {
                                 fontSize: 30,
                                 color: '#fff',
                                 fontFamily: 'liquidCrystal',
                             },
                         }
                     },
                     value: 20
                 }]
             },
             {
                 name: '南区',
                 label: {
                     fontSize: 16,
                     color: '#fff',
                     show: true,
                     position: [5, 5],
                     formatter: function(params) {
                         var arr = [
                         '{association|' + params.data.name + '}',
                         '{peoNum|' + params.data.value + '}' + '家',
                         ];
                         return arr.join('\n\n');
                     },
                     rich: {
                         association: {
                             fontSize: 16,
                             color: '#fff',
                         },
                         peoNum: {
                             fontSize: 30,
                             color: '#fff',
                             fontFamily: 'liquidCrystal',
                         },
                     }
                 },
                 value: 157,
                 children: [{
                     name: '广州',
                     label: {
                         fontSize: 16,
                         color: '#fff',
                         show: true,
                         position: [5, 5],
                         formatter: function(params) {
                             var arr = [
                             '{association|' + params.data.name + '}',
                             '{peoNum|' + params.data.value + '}' + '家',
                             ];
                             return arr.join('\n\n');
                         },
                         rich: {
                             association: {
                                 fontSize: 16,
                                 color: '#fff',
                             },
                             peoNum: {
                                 fontSize: 30,
                                 color: '#fff',
                                 fontFamily: 'liquidCrystal',
                             },
                         }
                     },
                     value: 94,
                     children: [{
                         name: '广东',
                         label: {
                             fontSize: 16,
                             color: '#fff',
                             show: true,
                             position: [5, 5],
                             formatter: function(params) {
                                 var arr = [
                                 '{association|' + params.data.name + '}',
                                 '{peoNum|' + params.data.value + '}' + '家',
                                 ];
                                 return arr.join('\n\n');
                             },
                             rich: {
                                 association: {
                                     fontSize: 16,
                                     color: '#fff',
                                 },
                                 peoNum: {
                                     fontSize: 30,
                                     color: '#fff',
                                     fontFamily: 'liquidCrystal',
                                 },
                             }
                         },
                         value: 20,
                     },
                     {
                         name: '深圳',
                         label: {
                             fontSize: 16,
                             color: '#fff',
                             show: true,
                             position: [5, 5],
                             formatter: function(params) {
                                 var arr = [
                                 '{association|' + params.data.name + '}',
                                 '{peoNum|' + params.data.value + '}' + '家',
                                 ];
                                 return arr.join('\n\n');
                             },
                             rich: {
                                 association: {
                                     fontSize: 16,
                                     color: '#fff',
                                 },
                                 peoNum: {
                                     fontSize: 30,
                                     color: '#fff',
                                     fontFamily: 'liquidCrystal',
                                 },
                             }
                         },
                         value: 40
                     },
                     {
                         name: '中山',
                         label: {
                             fontSize: 16,
                             color: '#fff',
                             show: true,
                             position: [5, 5],
                             formatter: function(params) {
                                 var arr = [
                                 '{association|' + params.data.name + '}',
                                 '{peoNum|' + params.data.value + '}' + '家',
                                 ];
                                 return arr.join('\n\n');
                             },
                             rich: {
                                 association: {
                                     fontSize: 16,
                                     color: '#fff',
                                 },
                                 peoNum: {
                                     fontSize: 30,
                                     color: '#fff',
                                     fontFamily: 'liquidCrystal',
                                 },
                             }
                         },
                         value: 10
                     },
                     {
                         name: '东莞',
                         label: {
                             fontSize: 16,
                             color: '#fff',
                             show: true,
                             position: [5, 5],
                             formatter: function(params) {
                                 var arr = [
                                 '{association|' + params.data.name + '}',
                                 '{peoNum|' + params.data.value + '}' + '家',
                                 ];
                                 return arr.join('\n\n');
                             },
                             rich: {
                                 association: {
                                     fontSize: 16,
                                     color: '#fff',
                                 },
                                 peoNum: {
                                     fontSize: 30,
                                     color: '#fff',
                                     fontFamily: 'liquidCrystal',
                                 },
                             }
                         },
                         value: 24
                     }
                     ]
                 }, {
                     name: '湖南',
                     label: {
                         fontSize: 16,
                         color: '#fff',
                         show: true,
                         position: [5, 5],
                         formatter: function(params) {
                             var arr = [
                             '{association|' + params.data.name + '}',
                             '{peoNum|' + params.data.value + '}' + '家',
                             ];
                             return arr.join('\n\n');
                         },
                         rich: {
                             association: {
                                 fontSize: 16,
                                 color: '#fff',
                             },
                             peoNum: {
                                 fontSize: 30,
                                 color: '#fff',
                                 fontFamily: 'liquidCrystal',
                             },
                         }
                     },
                     value: 20
                 }, {
                     name: '湖北',
                     label: {
                         fontSize: 16,
                         color: '#fff',
                         show: true,
                         position: [5, 5],
                         formatter: function(params) {
                             var arr = [
                             '{association|' + params.data.name + '}',
                             '{peoNum|' + params.data.value + '}' + '家',
                             ];
                             return arr.join('\n\n');
                         },
                         rich: {
                             association: {
                                 fontSize: 16,
                                 color: '#fff',
                             },
                             peoNum: {
                                 fontSize: 30,
                                 color: '#fff',
                                 fontFamily: 'liquidCrystal',
                             },
                         }
                     },
                     value: 22
                 }, {
                     name: '广西',
                     label: {
                         fontSize: 16,
                         color: '#fff',
                         show: true,
                         position: [5, 5],
                         formatter: function(params) {
                             var arr = [
                             '{association|' + params.data.name + '}',
                             '{peoNum|' + params.data.value + '}' + '家',
                             ];
                             return arr.join('\n\n');
                         },
                         rich: {
                             association: {
                                 fontSize: 16,
                                 color: '#fff',
                             },
                             peoNum: {
                                 fontSize: 30,
                                 color: '#fff',
                                 fontFamily: 'liquidCrystal',
                             },
                         }
                     },
                     value: 21
                 }]
             },
             {
                 name: '北区',
                 label: {
                     fontSize: 16,
                     color: '#fff',
                     show: true,
                     position: [5, 5],
                     formatter: function(params) {
                         var arr = [
                         '{association|' + params.data.name + '}',
                         '{peoNum|' + params.data.value + '}' + '家',
                         ];
                         return arr.join('\n\n');
                     },
                     rich: {
                         association: {
                             fontSize: 16,
                             color: '#fff',
                         },
                         peoNum: {
                             fontSize: 30,
                             color: '#fff',
                             fontFamily: 'liquidCrystal',
                         },
                     }
                 },
                 value: 148,
                 children: [{
                     name: '北京',
                     label: {
                         fontSize: 16,
                         color: '#fff',
                         show: true,
                         position: [5, 5],
                         formatter: function(params) {
                             var arr = [
                             '{association|' + params.data.name + '}',
                             '{peoNum|' + params.data.value + '}' + '家',
                             ];
                             return arr.join('\n\n');
                         },
                         rich: {
                             association: {
                                 fontSize: 16,
                                 color: '#fff',
                             },
                             peoNum: {
                                 fontSize: 30,
                                 color: '#fff',
                                 fontFamily: 'liquidCrystal',
                             },
                         }
                     },
                     value: 74,
                     children: [{
                         name: '东城',
                         label: {
                             fontSize: 16,
                             color: '#fff',
                             show: true,
                             position: [5, 5],
                             formatter: function(params) {
                                 var arr = [
                                 '{association|' + params.data.name + '}',
                                 '{peoNum|' + params.data.value + '}' + '家',
                                 ];
                                 return arr.join('\n\n');
                             },
                             rich: {
                                 association: {
                                     fontSize: 16,
                                     color: '#fff',
                                 },
                                 peoNum: {
                                     fontSize: 30,
                                     color: '#fff',
                                     fontFamily: 'liquidCrystal',
                                 },
                             }
                         },
                         value: 20
                     },
                     {
                         name: '西城',
                         label: {
                             fontSize: 16,
                             color: '#fff',
                             show: true,
                             position: [5, 5],
                             formatter: function(params) {
                                 var arr = [
                                 '{association|' + params.data.name + '}',
                                 '{peoNum|' + params.data.value + '}' + '家',
                                 ];
                                 return arr.join('\n\n');
                             },
                             rich: {
                                 association: {
                                     fontSize: 16,
                                     color: '#fff',
                                 },
                                 peoNum: {
                                     fontSize: 30,
                                     color: '#fff',
                                     fontFamily: 'liquidCrystal',
                                 },
                             }
                         },
                         value: 20
                     },
                     {
                         name: '石景山',
                         label: {
                             fontSize: 16,
                             color: '#fff',
                             show: true,
                             position: [5, 5],
                             formatter: function(params) {
                                 var arr = [
                                 '{association|' + params.data.name + '}',
                                 '{peoNum|' + params.data.value + '}' + '家',
                                 ];
                                 return arr.join('\n\n');
                             },
                             rich: {
                                 association: {
                                     fontSize: 16,
                                     color: '#fff',
                                 },
                                 peoNum: {
                                     fontSize: 30,
                                     color: '#fff',
                                     fontFamily: 'liquidCrystal',
                                 },
                             }
                         },
                         value: 10
                     },
                     {
                         name: '朝阳',
                         label: {
                             fontSize: 16,
                             color: '#fff',
                             show: true,
                             position: [5, 5],
                             formatter: function(params) {
                                 var arr = [
                                 '{association|' + params.data.name + '}',
                                 '{peoNum|' + params.data.value + '}' + '家',
                                 ];
                                 return arr.join('\n\n');
                             },
                             rich: {
                                 association: {
                                     fontSize: 16,
                                     color: '#fff',
                                 },
                                 peoNum: {
                                     fontSize: 30,
                                     color: '#fff',
                                     fontFamily: 'liquidCrystal',
                                 },
                             }
                         },
                         value: 24
                     }
                     ]
                 }, {
                     name: '湖北',
                     label: {
                         fontSize: 16,
                         color: '#fff',
                         show: true,
                         position: [5, 5],
                         formatter: function(params) {
                             var arr = [
                             '{association|' + params.data.name + '}',
                             '{peoNum|' + params.data.value + '}' + '家',
                             ];
                             return arr.join('\n\n');
                         },
                         rich: {
                             association: {
                                 fontSize: 16,
                                 color: '#fff',
                             },
                             peoNum: {
                                 fontSize: 30,
                                 color: '#fff',
                                 fontFamily: 'liquidCrystal',
                             },
                         }
                     },
                     value: 23
                 }, {
                     name: '天津',
                     label: {
                         fontSize: 16,
                         color: '#fff',
                         show: true,
                         position: [5, 5],
                         formatter: function(params) {
                             var arr = [
                             '{association|' + params.data.name + '}',
                             '{peoNum|' + params.data.value + '}' + '家',
                             ];
                             return arr.join('\n\n');
                         },
                         rich: {
                             association: {
                                 fontSize: 16,
                                 color: '#fff',
                             },
                             peoNum: {
                                 fontSize: 30,
                                 color: '#fff',
                                 fontFamily: 'liquidCrystal',
                             },
                         }
                     },
                     value: 24
                 }, {
                     name: '黑龙江',
                     label: {
                         fontSize: 16,
                         color: '#fff',
                         show: true,
                         position: [5, 5],
                         formatter: function(params) {
                             var arr = [
                             '{association|' + params.data.name + '}',
                             '{peoNum|' + params.data.value + '}' + '家',
                             ];
                             return arr.join('\n\n');
                         },
                         rich: {
                             association: {
                                 fontSize: 16,
                                 color: '#fff',
                             },
                             peoNum: {
                                 fontSize: 30,
                                 color: '#fff',
                                 fontFamily: 'liquidCrystal',
                             },
                         }
                     },
                     value: 27
                 }]
             }
             ]*/
        }]
    };
    treemap.setOption(option);

    // 异步每隔指定的时间请求数据;
    window.setInterval(function () {
        $.ajax({
            type: 'get',
            url: "http://127.0.0.1:8010/get_data",
            dataType: "json"
        }).done(function () {
            $("#treemap").addClass("chart-done");
        }).done(function (data) {
            // console.log('Data: ', data);
            const chartData = [];
            for (let i in data) {
                chartData.push({
                    name: data[i].region,
                    value: data[i].count
                });
            }
            treemap.setOption({
                series: [{
                    name: "门诊驾驶舱",
                    data: chartData
                }]
            });
        }).fail(function (jqXHR) {
            console.log("Ajax请求数据失败!(可能是对方服务已关闭或json数据格式有问题[比如说:json格式仅使用双引号]!): ", jqXHR.status, jqXHR.statusText);
        })
    }, 5000);

</script>
</html>
